<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المهمة المستحيلة | لعبة المغامرات</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            direction: rtl;
            overflow: hidden;
        }

        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        .header {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            font-size: 1.2em;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
            backdrop-filter: blur(10px);
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(160deg, #2c3e50, #34495e);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            margin: 20px 0;
        }

        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border-radius: 50%;
            box-shadow: 0 0 20px #4ecdc4;
            transition: all 0.1s ease;
        }

        .coin {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #ffd700, #ff6b00);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 15px #ffd700;
        }

        .enemy {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            border-radius: 8px;
            animation: rotate 3s infinite linear;
        }

        .controls {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        button {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 25px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px;
            border-radius: 20px;
            display: none;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #feca57;
            border-radius: 50%;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>🎯 المهمة المستحيلة</h1>
            <p>اجمع النقاط وتجنب الأعداء! استخدم مفاتيح الأسهم للتحرك</p>
        </div>

        <div class="stats">
            <div class="stat-box">
                <div>🎯 النقاط</div>
                <div id="score">0</div>
            </div>
            <div class="stat-box">
                <div>❤️ الحياة</div>
                <div id="lives">3</div>
            </div>
            <div class="stat-box">
                <div>⏱️ الوقت</div>
                <div id="timer">60</div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div id="player"></div>
            <!-- العناصر تظهر بالجافاسكريبت -->
        </div>

        <div class="controls">
            <button onclick="startGame()">▶️ بدء اللعبة</button>
            <button onclick="resetGame()">🔄 إعادة开始</button>
            <button onclick="showInstructions()">📋 التعليمات</button>
        </div>
    </div>

    <div class="message" id="gameMessage">
        <h2 id="messageTitle"></h2>
        <p id="messageText"></p>
        <button onclick="hideMessage()">موافق</button>
    </div>

    <script>
        // العناصر الأساسية
        const gameArea = document.getElementById('gameArea');
        const player = document.getElementById('player');
        const scoreElement = document.getElementById('score');
        const livesElement = document.getElementById('lives');
        const timerElement = document.getElementById('timer');
        const gameMessage = document.getElementById('gameMessage');
        const messageTitle = document.getElementById('messageTitle');
        const messageText = document.getElementById('messageText');

        // متغيرات اللعبة
        let score = 0;
        let lives = 3;
        let timeLeft = 60;
        let gameInterval;
        let timerInterval;
        let isGameRunning = false;
        let playerPosition = { x: 375, y: 175 };

        // تهيئة اللاعب
        player.style.left = playerPosition.x + 'px';
        player.style.top = playerPosition.y + 'px';

        // التحكم باللاعب
        document.addEventListener('keydown', (e) => {
            if (!isGameRunning) return;

            const speed = 20;
            const gameRect = gameArea.getBoundingClientRect();
            const playerSize = 50;

            switch(e.key) {
                case 'ArrowUp':
                    playerPosition.y = Math.max(0, playerPosition.y - speed);
                    break;
                case 'ArrowDown':
                    playerPosition.y = Math.min(gameRect.height - playerSize, playerPosition.y + speed);
                    break;
                case 'ArrowLeft':
                    playerPosition.x = Math.max(0, playerPosition.x - speed);
                    break;
                case 'ArrowRight':
                    playerPosition.x = Math.min(gameRect.width - playerSize, playerPosition.x + speed);
                    break;
            }

            player.style.left = playerPosition.x + 'px';
            player.style.top = playerPosition.y + 'px';
            checkCollisions();
        });

        // إنشاء العملات
        function createCoin() {
            if (!isGameRunning) return;

            const coin = document.createElement('div');
            coin.className = 'coin';
            coin.style.left = Math.random() * (gameArea.offsetWidth - 30) + 'px';
            coin.style.top = Math.random() * (gameArea.offsetHeight - 30) + 'px';
            gameArea.appendChild(coin);

            // إزالة العملة بعد 5 ثواني
            setTimeout(() => {
                if (coin.parentNode) {
                    coin.remove();
                }
            }, 5000);
        }

        // إنشاء الأعداء
        function createEnemy() {
            if (!isGameRunning) return;

            const enemy = document.createElement('div');
            enemy.className = 'enemy';
            enemy.style.left = Math.random() * (gameArea.offsetWidth - 40) + 'px';
            enemy.style.top = Math.random() * (gameArea.offsetHeight - 40) + 'px';
            gameArea.appendChild(enemy);
        }

        // الكشف عن التصادمات
        function checkCollisions() {
            const playerRect = player.getBoundingClientRect();
            
            // الكشف عن العملات
            document.querySelectorAll('.coin').forEach(coin => {
                const coinRect = coin.getBoundingClientRect();
                if (isColliding(playerRect, coinRect)) {
                    collectCoin(coin);
                }
            });

            // الكشف عن الأعداء
            document.querySelectorAll('.enemy').forEach(enemy => {
                const enemyRect = enemy.getBoundingClientRect();
                if (isColliding(playerRect, enemyRect)) {
                    hitEnemy(enemy);
                }
            });
        }

        function isColliding(rect1, rect2) {
            return !(rect1.right < rect2.left || 
                     rect1.left > rect2.right || 
                     rect1.bottom < rect2.top || 
                     rect1.top > rect2.bottom);
        }

        function collectCoin(coin) {
            score += 10;
            scoreElement.textContent = score;
            createParticles(coin.getBoundingClientRect());
            coin.remove();
            
            // تأثير صوتي (افتراضي)
            const audio = new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==");
            audio.play().catch(() => {});
        }

        function hitEnemy(enemy) {
            lives--;
            livesElement.textContent = lives;
            createParticles(enemy.getBoundingClientRect());
            enemy.remove();

            if (lives <= 0) {
                endGame('💀 Game Over!', 'انتهت حياتك! حاول مرة أخرى.');
            }
        }

        function createParticles(position) {
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = (position.left + position.width / 2) + 'px';
                particle.style.top = (position.top + position.height / 2) + 'px';
                document.body.appendChild(particle);

                const angle = Math.random() * Math.PI * 2;
                const speed = 2 + Math.random() * 3;
                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;

                let opacity = 1;
                const particleInterval = setInterval(() => {
                    const rect = particle.getBoundingClientRect();
                    particle.style.left = (rect.left + vx) + 'px';
                    particle.style.top = (rect.top + vy) + 'px';
                    opacity -= 0.02;
                    particle.style.opacity = opacity;

                    if (opacity <= 0) {
                        clearInterval(particleInterval);
                        particle.remove();
                    }
                }, 16);
            }
        }

        // المؤقت
        function startTimer() {
            timeLeft = 60;
            timerElement.textContent = timeLeft;
            
            timerInterval = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;

                if (timeLeft <= 0) {
                    endGame('⏰ الوقت انتهى!', `نهائيتك: ${score} نقطة`);
                }
            }, 1000);
        }

        // بدء اللعبة
        function startGame() {
            if (isGameRunning) return;
            
            isGameRunning = true;
            score = 0;
            lives = 3;
            scoreElement.textContent = score;
            livesElement.textContent = lives;
            
            // تنظيف المنطقة
            document.querySelectorAll('.coin, .enemy').forEach(el => el.remove());
            
            // بدء المؤقت
            startTimer();
            
            // إنشاء العناصر
            gameInterval = setInterval(() => {
                createCoin();
                if (Math.random() < 0.3) createEnemy();
            }, 2000);

            showMessage('🎮 ابدأ!', 'استخدم مفاتيح الأسهم للتحرك واجمع النقاط!');
        }

        function endGame(title, text) {
            isGameRunning = false;
            clearInterval(gameInterval);
            clearInterval(timerInterval);
            showMessage(title, text);
        }

        function resetGame() {
            isGameRunning = false;
            clearInterval(gameInterval);
            clearInterval(timerInterval);
            
            score = 0;
            lives = 3;
            timeLeft = 60;
            
            scoreElement.textContent = score;
            livesElement.textContent = lives;
            timerElement.textContent = timeLeft;
            
            playerPosition = { x: 375, y: 175 };
            player.style.left = playerPosition.x + 'px';
            player.style.top = playerPosition.y + 'px';
            
            document.querySelectorAll('.coin, .enemy').forEach(el => el.remove());
        }

        function showInstructions() {
            showMessage('📋 التعليمات', `
                🎯 هدف اللعبة: اجمع أكبر عدد من النقاط
                ⬆️⬇️⬅️➡️ : استخدم مفاتيح الأسهم للتحرك
                💰 اجمع العملات الذهبية: +10 نقاط
                ❌ تجنب المربعات الحمراء: -1 حياة
                ⏱️ لديك 60 ثانية فقط!
            `);
        }

        function showMessage(title, text) {
            messageTitle.textContent = title;
            messageText.textContent = text;
            gameMessage.style.display = 'block';
        }

        function hideMessage() {
            gameMessage.style.display = 'none';
        }

        // تهيئة أولية
        showInstructions();
    </script>
</body>
</html>
